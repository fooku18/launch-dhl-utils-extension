<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8">
    <link rel="stylesheet" href="//assets.adobedtm.com/activation/reactor/coralui/3.16.0/css/coral.css">
    <title>Event</title>
    <style>
      .keyValDiv{
        display: inline-block;
      }
      .removeMe:hover{
        cursor: pointer;
      }
    </style>
    <script>
        var build = (k = "") => {
            const div = document.createElement("div");
            div.classList.add("keyValPair");
            const template = `
                <div class="keyValDiv">
                    <label class="coral-Form-fieldlabel" for="key">Domain</label>
                    <input type="text" name="key" class="coral-Textfield" value="${k||''}" />
                </div>
                <div class="keyValDiv removeMe">
                    <a class="remove">X</a>
                    <a class="add">+</a>
                </div>
            `;
            div.innerHTML = template;
            div.querySelector(".removeMe a.remove").addEventListener("click", function(e){
                div.parentNode.removeChild(div);
            }, !0);
            div.querySelector(".removeMe a.add").addEventListener("click", function(e){
            div.parentNode.appendChild(build());
            }, !0);
            return div;
        }
    </script>
  </head>
  <body class="coral--light">
    <form class="coral-Form coral-Form--vertical">
      <section class="coral-Form-fieldset">
      </section>
    </form>
    <script src="https://assets.adobedtm.com/activation/reactor/extensionbridge/extensionbridge.min.js"></script>
    <script>
      window.extensionBridge.register({
        init: function(info) {
          if (info.settings&&info.settings.domains.length>0) {
            info.settings.domains.forEach(domain => {
              document.querySelector("section").appendChild(build(domain));
            })
          }else{
            document.querySelector("section").appendChild(build());
          }
        },
        getSettings: function() {
          var ret = [];
          Array.prototype.slice.call(document.querySelectorAll(".keyValPair")).forEach(element => {
            if(element.querySelector("input[name='key']").value)
              ret.push(element.querySelector("input[name='key']").value);
          });
          return {
            domains: ret
          };
        },
        validate: function() {
          return !0;
        }
      });
    </script>
  </body>
</html>